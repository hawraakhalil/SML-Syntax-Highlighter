<html>
<body><tt>
<span style="color: #00aaff;">(* Functions needed from HW1 and modified for pattern matching *)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>rgb2gray</span>&nbsp;<span>rgb</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>rgb</span>&nbsp;<span style="color:#a0a000;">of</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">(</span><span>r</span><span style="color:#0000ff;">,</span>&nbsp;<span>g</span><span style="color:#0000ff;">,</span>&nbsp;<span>b</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#0000ff;">(</span><span>r</span><span style="color:#0000ff;">*</span><span style="color:#ff0000;">3</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>g</span><span style="color:#0000ff;">*</span><span style="color:#ff0000;">6</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>b</span><span style="color:#0000ff;">)</span>&nbsp;<span>div</span>&nbsp;<span style="color:#ff0000;">10</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>isBrighter</span><span style="color:#0000ff;">(</span><span>rgb1</span><span style="color:#0000ff;">,</span>&nbsp;<span>rgb2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>rgb1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>rgb2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">true</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#ff0000;">false</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>brightest</span><span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">fun</span>&nbsp;<span>brightesthelper</span><span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span>max</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>image</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>max</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span>pixel</span><span style="color:#0000ff;">::</span><span>image'</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>isBrighter</span><span style="color:#0000ff;">(</span><span>pixel</span><span style="color:#0000ff;">,</span>&nbsp;<span>max</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>brightesthelper</span><span style="color:#0000ff;">(</span><span>image'</span><span style="color:#0000ff;">,</span>&nbsp;<span>pixel</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>brightesthelper</span><span style="color:#0000ff;">(</span><span>image'</span><span style="color:#0000ff;">,</span>&nbsp;<span>max</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>brightesthelper</span><span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">0</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">0</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">0</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color: #00aaff;">(* Part 1 *)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>countWhite</span>&nbsp;<span>images</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">let</span>&nbsp;<span style="color:#a0a000;">fun</span>&nbsp;<span>aux</span><span style="color:#0000ff;">(</span><span>images</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>images</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">[</span><span style="color:#0000ff;">]</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>acc</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span>image</span><span style="color:#0000ff;">::</span><span>images'</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>rgb2gray</span><span style="color:#0000ff;">(</span><span>brightest</span><span style="color:#0000ff;">(</span><span>image</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff0000;">255</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span>aux</span><span style="color:#0000ff;">(</span><span>images'</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">+</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>aux</span><span style="color:#0000ff;">(</span><span>images'</span><span style="color:#0000ff;">,</span>&nbsp;<span>acc</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">in</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span>aux</span><span style="color:#0000ff;">(</span><span>images</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">0</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">end</span><br>
<br>
<span style="color: #00aaff;">(* Part 2 *)</span><br>
<span style="color:#a0a000;">datatype</span>&nbsp;<span style="color:#ff00ff;">Node</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff00ff;">Leaf</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<span style="color:#00c000;">int</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<span style="color:#00c000;">int</span>&nbsp;<span style="color:#0000ff;">*</span>&nbsp;<span style="color:#ff00ff;">Node</span>&nbsp;<span style="color:#0000ff;">*</span>&nbsp;<span style="color:#ff00ff;">Node</span>&nbsp;<br>
<span style="color:#a0a000;">val</span>&nbsp;<span>myTree</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>nodeValue</span>&nbsp;<span>n</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>n</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff00ff;">Leaf</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>a</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span>a</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span>b</span>&nbsp;<span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>a</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>treeSize</span>&nbsp;<span>n</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>n</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff00ff;">Leaf</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#ff0000;">1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span>&nbsp;<span>b</span>&nbsp;<span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>treeSize</span><span style="color:#0000ff;">(</span><span>b</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>treeSize</span><span style="color:#0000ff;">(</span><span>c</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>numLeaves</span>&nbsp;<span>n</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>n</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff00ff;">Leaf</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#ff0000;">1</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span>&nbsp;<span>b</span><span style="color:#0000ff;">,</span>&nbsp;<span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>numLeaves</span><span style="color:#0000ff;">(</span><span>b</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>numLeaves</span><span style="color:#0000ff;">(</span><span>c</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>numGreaterThan</span>&nbsp;<span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">,</span>&nbsp;<span>num</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>n</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff00ff;">Leaf</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>num</span>&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#ff0000;">0</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span><span>b</span><span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>num</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>numGreaterThan</span><span style="color:#0000ff;">(</span><span>b</span><span style="color:#0000ff;">,</span>&nbsp;<span>num</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>numGreaterThan</span><span style="color:#0000ff;">(</span><span>c</span><span style="color:#0000ff;">,</span>&nbsp;<span>num</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>numGreaterThan</span><span style="color:#0000ff;">(</span><span>b</span><span style="color:#0000ff;">,</span>&nbsp;<span>num</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>numGreaterThan</span><span style="color:#0000ff;">(</span><span>c</span><span style="color:#0000ff;">,</span>&nbsp;<span>num</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>traverseTree</span>&nbsp;<span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">,</span>&nbsp;<span>f</span><span style="color:#0000ff;">,</span>&nbsp;<span>g</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#a0a000;">case</span>&nbsp;<span>n</span>&nbsp;<span style="color:#a0a000;">of</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#ff00ff;">Leaf</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>f</span><span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">)</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#0000ff;">|</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span><span>b</span><span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span>g</span><span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span><span>traverseTree</span><span style="color:#0000ff;">(</span><span>b</span><span style="color:#0000ff;">,</span><span>f</span><span style="color:#0000ff;">,</span><span>g</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span><span>traverseTree</span><span style="color:#0000ff;">(</span><span>c</span><span style="color:#0000ff;">,</span><span>f</span><span style="color:#0000ff;">,</span><span>g</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>traverse</span><span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span>traverseTree</span><span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span>fn</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#ff00ff;">Int</span><span style="color:#0000ff;">.</span><span>toString</span>&nbsp;<span>a</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span>fn</span>&nbsp;<span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span><span>b</span><span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span><span style="color:#ff00ff;">Int</span><span style="color:#0000ff;">.</span><span>toString</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span style="color: #ff0000;">" "</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span>b</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span style="color: #ff0000;">" "</span>&nbsp;<span style="color:#0000ff;">^</span>&nbsp;<span>c</span>&nbsp;<span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>treeSize2</span><span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span><br>
&nbsp;&nbsp;&nbsp;&nbsp;<span>traverseTree</span><span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span>fn</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#ff0000;">1</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span>fn</span>&nbsp;<span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span><span>b</span><span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>b</span>&nbsp;<span style="color:#0000ff;">+</span>&nbsp;<span>c</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<span style="color:#a0a000;">fun</span>&nbsp;<span>numGreaterThan2</span><span style="color:#0000ff;">(</span><span>n</span><span style="color:#0000ff;">,</span>&nbsp;<span>num</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<br>
&nbsp;&nbsp;&nbsp;&nbsp;<span>traverseTree</span><span style="color:#0000ff;">(</span>&nbsp;<span>n</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span>fn</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>num</span>&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span>&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span style="color:#ff0000;">0</span>&nbsp;<span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span>fn</span>&nbsp;<span style="color:#0000ff;">(</span><span>a</span><span style="color:#0000ff;">,</span><span>b</span><span style="color:#0000ff;">,</span><span>c</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">=></span>&nbsp;<span style="color:#a0a000;">if</span>&nbsp;<span>a</span>&nbsp;<span style="color:#0000ff;">></span>&nbsp;<span>num</span>&nbsp;<span style="color:#a0a000;">then</span>&nbsp;<span style="color:#ff0000;">1</span><span style="color:#0000ff;">+</span><span>b</span><span style="color:#0000ff;">+</span><span>c</span>&nbsp;<span style="color:#a0a000;">else</span>&nbsp;<span>b</span><span style="color:#0000ff;">+</span><span>c</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><br>
<br>
<span style="color: #00aaff;">(* Tests *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result1</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>countWhite</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">255</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">150</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">190</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">250</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">255</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">255</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">100</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">150</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">200</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">,</span><span style="color:#0000ff;">[</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">120</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">170</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">220</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#0000ff;">(</span><span style="color:#ff0000;">150</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">190</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">250</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">]</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 2 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result2</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>nodeValue</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 4 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result3</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>treeSize</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 5 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result4</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>numLeaves</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 3 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result5</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>numGreaterThan</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 3 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result6</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>traverse</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: "2 1 3 5 4" *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result7</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>treeSize2</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 5 *)</span><br>
<span style="color:#a0a000;">val</span>&nbsp;<span>result8</span>&nbsp;<span style="color:#0000ff;">=</span>&nbsp;<span>numGreaterThan2</span><span style="color:#0000ff;">(</span><span style="color:#0000ff;">(</span><span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">2</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">NonLeaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">1</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">3</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">5</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff00ff;">Leaf</span><span style="color:#0000ff;">(</span><span style="color:#ff0000;">4</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color:#0000ff;">,</span>&nbsp;<span style="color:#ff0000;">2</span><span style="color:#0000ff;">)</span>&nbsp;<span style="color: #00aaff;">(* expected output: 3 *)</span><br>
</body>
</html></tt>
